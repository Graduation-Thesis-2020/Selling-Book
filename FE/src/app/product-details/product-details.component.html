<section style="background-color: antiquewhite;
        background-image: url(https://cdn.pixabay.com/photo/2018/12/18/22/29/background-3883179_960_720.jpg);
        background-repeat: no-repeat;
        background-size: 100% 100%;
        height: 300px;">
  <div class="header">
    <div class="container">
      <div class="logo">
        <h1>
          <a [routerLink]="['/home']"><b>T<br />H<br />E</b>Book Store<span>The Best Store Online</span></a>
        </h1>
      </div>


      <div class="header-ri">
        <ul class="social-top">
          <li>
            <a href="https://www.facebook.com/koolsssssss" class="icon facebook"><i class="fa fa-facebook"
                aria-hidden="true"></i><span></span></a>
          </li>
          <li>
            <a href="https://www.facebook.com/hung.lu1998" class="icon twitter"><i class="fa fa-twitter"
                aria-hidden="true"></i><span></span></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!--Menu-->
  <div class="container">
    <nav class="navbar navbar-expand-lg border-bottom">
      <a class="navbar-brand" style="font-size: 24px; color: antiquewhite; margin-right: 0px;"
        [routerLink]="['/home']"><i class="fas fa-book" style="padding-top: 30px;"></i></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <div class="nav-top mr-auto">
          <nav class="navbar navbar-default ">
            <div class="ccc">
              <ul class="nav navbar-nav">
                <li>
                  <a [routerLink]="['/home']" class="hyper"><span>Trang Chủ</span></a>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle hyper" data-toggle="dropdown"><span>Thể loại<b
                        class="caret"></b></span></a>
                  <ul class="dropdown-menu multi">
                    <div class="row">
                      <div class="col-sm-3" *ngFor="let cate of cates1">
                        <ul class="multi-column-dropdown">
                          <li>
                            <a routerLink="/books/{{ cate._id }}/categories/{{
                                cate.name
                              }}"><i class="fa fa-angle-right" aria-hidden="true"></i>{{ cate.name }}</a>
                          </li>
                        </ul>
                      </div>
                      <div class="clearfix"></div>
                    </div>
                  </ul>
                </li>
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle hyper" data-toggle="dropdown"><span> Nhà Xuất Bản <b
                        class="caret"></b></span></a>
                  <ul class="dropdown-menu multi multi1">
                    <div class="row">
                      <div class="col-sm-3" *ngFor="let pub of pubs">
                        <ul class="multi-column-dropdown">
                          <li>
                            <a routerLink="/books/{{ pub._id }}/publishers/{{
                                pub.name
                              }}"><i class="fa fa-angle-right" aria-hidden="true"></i>{{ pub.name }}
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="clearfix"></div>
                    </div>
                  </ul>
                </li>
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle hyper" data-toggle="dropdown"><span>Tác Giả<b
                        class="caret"></b></span></a>
                  <ul class="dropdown-menu multi multi2">
                    <div class="row">
                      <div class="col-sm-3" *ngFor="let aut of auts">
                        <ul class="multi-column-dropdown">
                          <li>
                            <a routerLink="/books/{{ aut._id }}/authors/{{
                                aut.name
                              }}"><i class="fa fa-angle-right" aria-hidden="true"></i>{{ aut.name }}</a>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </ul>
                </li>
                <li class="dropdown">
                  <a [routerLink]="['/books']" class="dropdown-toggle hyper" data-toggle="dropdown"><span> Tất Cả Sách
                    </span></a>
                </li>
                <li class="dropdown">
                  <a [routerLink]="['/sale']" class="dropdown-toggle hyper" data-toggle="dropdown"><span> Ưu Đãi
                    </span></a>
                  <div class="offer-menu">
                    <p><span>Giảm giá</span></p>
                  </div>
                </li>
              </ul>

            </div>
          </nav>
        </div>

        <div class="cart">
          <a [routerLink]="['/cart']"><span class="fa fa-shopping-cart my-cart-icon">(<small>{{ countItem
                }}</small>)</span></a>
        </div>

      </div>

    </nav>



  </div>

</section>
<ng-template #t let-fill="fill">
  <span class="star" [class.full]="fill === 100">
    <span class="half" [style.width.%]="fill">&hearts;</span>&hearts;
  </span>
</ng-template>
<div class="content-top">
  <div class="container">
    <div class="col-m">
      <div class="row">
        <div class="col-5">
          <a class="offer-img">
            <img src="{{ books.imageUrl }}" class="img-responsive" alt="" />
          </a>
        </div>

        <div class="col-7">
          <div class="single-right">
            <h3>{{ books.title }}</h3>
            <div class="row" style="margin-left: 0px;" *ngIf="rating.message == null">
              <ngb-rating  rate="{{rating.average}}" [starTemplate]="t" [readonly]="true" [max]="5"></ngb-rating>
              <div class="number-rate">
                ({{rating.total}} đánh giá)
              </div>
            </div>
            <div class="row" style="margin-left: 0px;" *ngIf="rating.total == null">
              <ngb-rating rate="0" [starTemplate]="t" [readonly]="true" [max]="5"></ngb-rating>
              <div class="number-rate" *ngIf="mess == null">
                (0 đánh giá)
              </div>
            </div>

            <div class="author">
              <div class="row" style="margin-left: 0px;">
                <span style="margin-right: 3px; font-size: 18px;">Tác giả: </span>
                <div class="more">
                  <a routerLink="/books/{{ books.author._id }}/authors/{{books.author.name}}  "> {{ author.name }}</a>
                </div>
              </div>
            </div>
            <div style="margin-top: 10px;" *ngIf="books.price !== 0">
              <span style="color: darkgray; font-weight: normal;">Có sẵn: {{books.availableQuantity}} sản phẩm</span>
            </div>

            <div class="mid-2" *ngIf="books.price !== 0">
              <p class="price1" *ngIf="books.discount === 0">{{ books.price }} đ</p>
              <p class="price" *ngIf="books.discount > 0">
                <label>{{ books.price }} đ</label><em class="item_price">{{ books.discount }} đ</em>
              </p>
            </div>

            <div class="coming-img" style="text-align: center; padding-top: 23px;" *ngIf="books.price == 0">
              <img
                src="https://media.istockphoto.com/vectors/red-rubber-stamp-icon-on-transparent-background-vector-id919297480?b=1&k=6&m=919297480&s=612x612&w=0&h=gkCjvO2o195wYTLNiVKD-7VkajMzgj-_AOmLTmmrL8g="
                alt="" width="" height="">
            </div>

            <div class="add-cart" *ngIf="books.price !== 0 && books.availableQuantity !== 0">
              <button class="btn btn-danger my-cart-btn my-cart-b" (click)="AddtoCart(books._id)">
                Thêm Giỏ Hàng
              </button>
            </div>

            <div class="soldout-img" *ngIf="books.availableQuantity == 0 && books.price !== 0">
              <img
                src="https://theme.hstatic.net/1000360022/1000651995/14/sold_out11.png?v=336"
                alt="" width="150px" height="150px">
            </div>




          </div>
        </div>
      </div>



    </div>

    <div class="descript">
      <p class="title">Thông tin chi tiết</p>
      <div class="table-detail">
        <div class="row" style="font-size: 18px;">
          <div class="col-3">
            Nhà xuất bản
          </div>
          <div class="col-9">
            {{books.publisher.name}}
          </div>
          <div class="col-3">
            Ngày xuất bản
          </div>
          <div class="col-9">
            {{books.publishDate | date:"dd/MM/yyyy"}}
          </div>
          <div class="col-3">
            Số trang
          </div>
          <div class="col-9">
            {{books.pageCount}}
          </div>
          <div class="col-3">
            Thể loại
          </div>
          <div class="col-9 row" style="margin-left: 0px;">
            <p class="catArray" *ngFor="let cat of cates">"{{cat.name}}"</p>
          </div>
        </div>
      </div>
    </div>

    <div class="descript">
      <p class="title">Mô tả sản phẩm</p>
      <p class="in-pa">{{ books.description }}</p>
    </div>

    <div class="descript">
      <div *ngIf="current">
        <p class="title">Nhận xét
        </p>
        <div class="col-e">
          <div class="rate form-group">
            <h5 style="font-weight: normal; margin-bottom: 0px;">
              Bình chọn: <span class="heart">
                <ngb-rating [formControl]="ctrl" [(rate)]="currentRate" [starTemplate]="t" [max]="5"></ngb-rating>
              </span>
            </h5>
            <div class="form-text small" >
              <div *ngIf="ctrl.valid && ctrl.value !== 0" class="text-success">Xin cảm ơn!</div>
              <div *ngIf="ctrl.invalid || ctrl.value==0" class="text-danger">Hãy chọn mức độ hài lòng của bạn!</div>
            </div>
          </div>
          <textarea  #comment class="form-control" placeholder="nhập bình luận.."></textarea>
        </div>
        <div class="submitRating">
          <button class="btn btn-danger" style="float: right;" (click)="save(comment.value)" tyle="button" [disabled]="ctrl.invalid || ctrl.value==0" >
            Gửi nhận xét
          </button>
        </div>
      </div>

      <div class="nologin_noreview" *ngIf="!current">
        <a routerLink="/login"> Đăng nhập</a> để có thể nhận xét.
      </div>


      <div class="showReview">
        <p class="title">Khách hàng đã nhận xét
          <span class="in-pa" *ngIf="rating.message == null">(hiện có {{rating.total}} lượt đánh giá)</span>
          <span class="in-pa" *ngIf="rating.total == null">(hiện có 0 lượt đánh giá)</span>
        </p>
      </div>
      <div *ngFor="let each of detail | paginate: config; let i = index">
        <div class="row pr-3 pl-2 " style="margin-top: 10px; padding-bottom: 20px;">
          <div class="col-auto">
            <div class="img-reponsive" *ngIf="!each.userId.imageUrl">
              <img src="https://www.freeiconspng.com/uploads/customers-icon-3.png" alt="">
            </div>
            <div class="img-reponsive" *ngIf="each.userId.imageUrl">
              <img src="{{each.userId.imageUrl}}" alt="">
            </div>
          </div>
          <div class="col pl-0">
            <div class="bg-review p-2">
              <p style="font-weight: 600; padding-bottom: 10px;"> {{each.userId.name}}
                <span style="color: red; font-size: 12px; padding-left: 10px;">{{each.review}} <i class="fas fa-heart"></i></span>
              </p>
              <p>{{each.comment}}</p>
            </div>
            <div class="pl-2" style="font-size: 14px; color: darkgray;">
              <!-- <span  style="font-weight: 500; color: cornflowerblue;" class="pr-0" *ngFor="let like of each.likes">
                <span *ngIf="like == idUser" class="pr-0">
                  <a style="font-weight: 600; color: cornflowerblue;" [routerLink]=""  (click)="LikeCmtParent(each._id)" >
                    <i class="fas fa-thumbs-up"></i>Đã Thích</a> <span> {{each.likes.length}}</span>
                </span>

              </span> -->
              <span  style="font-weight: 600; color: cornflowerblue;" class="pr-0" *ngIf="loadLike(each.likes) == 1">
                <span >
                  <a style="font-weight: 600; color: cornflowerblue;" [routerLink]=""  (click)="LikeCmtParent(each._id)" >
                    <i class="fas fa-thumbs-up"></i>Thích</a> <span style="font-weight: 600;"> {{each.likes.length}}</span>
                </span>
              </span>
              <span  style="font-weight: 400; color: cornflowerblue;" class="pr-0" *ngIf="loadLike(each.likes) == 0">
                <span >
                  <a style="font-weight: 400; color: cornflowerblue;" [routerLink]=""  (click)="LikeCmtParent(each._id)" >
                    <i class="far fa-thumbs-up"></i>Thích</a> <span style="font-weight: 600;"> {{each.likes.length}}</span>
                </span>
              </span>

              <a [routerLink]="" style="font-weight: 400; color: cornflowerblue;" class="pl-2 pr-2" (click)="showCmtChild(each._id)">
              <i class="far fa-comment-dots"></i>Trả lời
              </a>
              Ngày đăng: {{each.date | date: 'dd/MM/yyyy'}}
            </div>

            <!-- CmtChild -->


              <div class="row pt-4 pr-3"  *ngFor="let child of each.commentChilds">

                <div class="col-auto">
                  <div class="img-reponsiveChild" *ngIf="!child.userId.imageUrl">
                    <img src="https://www.freeiconspng.com/uploads/customers-icon-3.png" alt="">
                  </div>
                  <div class="img-reponsive" *ngIf="child.userId.imageUrl">
                    <img src="{{child.userId.imageUrl}}" alt="">
                  </div>
                </div>
                <div class="col pl-0">
                  <div class="bg-reviewChild p-2">
                    <p style="font-weight: 600; padding-bottom: 10px;"> {{child.userId.name}}

                    </p>
                    <p>{{child.comment}}</p>
                  </div>
                  <div  style="font-size: 14px; color: darkgray;">
                    <!-- <span  style="font-weight: 500; color: cornflowerblue;" class="pr-2">
                      <a style="font-weight: 500; color: cornflowerblue;" [routerLink]="" >  <i class="fas fa-thumbs-up"></i>Thích</a>
                    <span> {{child.likes.length}}</span>
                    </span> -->

                    <span  style="font-weight: 600; color: cornflowerblue;" class="pr-0" *ngIf="loadLike(child.likes) == 1">
                      <span >
                        <a style="font-weight: 600; color: cornflowerblue;" [routerLink]=""  (click)="LikeCmtChild(child._id)" >
                          <i class="fas fa-thumbs-up"></i>Thích</a> <span style="font-weight: 600;"> {{child.likes.length}}</span>
                      </span>
                    </span>
                    <span  style="font-weight: 400; color: cornflowerblue;" class="pr-0" *ngIf="loadLike(child.likes) == 0">
                      <span >
                        <a style="font-weight: 400; color: cornflowerblue;" [routerLink]=""  (click)="LikeCmtChild(child._id)" >
                          <i class="far fa-thumbs-up"></i>Thích</a> <span style="font-weight: 600;"> {{child.likes.length}}</span>
                      </span>
                    </span>

                    <a [routerLink]="" style="font-weight: 500; color: cornflowerblue;" class="pl-2 pr-2" (click)="showCmtChild(each._id)">
                    <i class="far fa-comment-dots"></i>Trả lời
                    </a>
                    Ngày đăng: {{child.date | date: 'dd/MM/yyyy'}}
                  </div>
                </div>

            </div>


            <!-- <div *ngIf="each.commentChilds.length==1">
              <div class="row pt-4 pr-3"  *ngFor="let child of each.commentChilds">

                <div class="col-auto">
                  <div class="img-reponsiveChild" *ngIf="!child.userId.imageUrl">
                    <img src="https://www.freeiconspng.com/uploads/customers-icon-3.png" alt="">
                  </div>
                  <div class="img-reponsive" *ngIf="child.userId.imageUrl">
                    <img src="{{child.userId.imageUrl}}" alt="">
                  </div>
                </div>
                <div class="col pl-0">
                  <div class="bg-reviewChild p-2">
                    <p style="font-weight: 600; padding-bottom: 10px;"> {{child.userId.name}}

                    </p>
                    <p>{{child.comment}}</p>
                  </div>
                  <div  style="font-size: 14px; color: darkgray;">
                    <span  style="font-weight: 500; color: cornflowerblue;" class="pr-2">
                      <a style="font-weight: 500; color: cornflowerblue;" routerLink="">  <i class="fas fa-thumbs-up"></i>Thích</a>
                    <span> {{numLike}}</span>
                    </span>
                    <a [routerLink]="" style="font-weight: 500; color: cornflowerblue;" class="pl-2 pr-2" (click)="showCmtChild(each._id)">
                    <i class="fas fa-comment-dots"></i>Trả lời
                    </a>
                    Ngày đăng: {{child.date | date: 'dd/MM/yyyy'}}
                  </div>
                </div>




            </div>
            </div> -->



            <!-- RepCmtChil -->

            <div class="row pt-2 pr-3" *ngIf="showChild && each._id==idChild">
              <div class="col-auto">
                <div class="img-reponsiveChild" *ngIf="!imageUser">
                  <img src="https://www.freeiconspng.com/uploads/customers-icon-3.png" alt="">
                </div>
                <div class="img-reponsiveChild" *ngIf="imageUser">
                  <img src="{{imageUser}}" alt="">
                </div>
              </div>

              <div class="col bg-reviewChild1 pl-0 pr-0" >
                <div class="input-group" >
                  <textarea class="form-control" aria-label="With textarea" #cmtchild></textarea>
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary btnChild" type="button" (click)="cmtChild(cmtchild.value)"><i class="fas fa-paper-plane"></i></button>
                  </div>
                </div>
                <!-- <div class="input-group mb-3">
                  <input  style="border-right: none;height: auto;" type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="basic-addon2">
                  <div class="input-group-append">
                    <span style="background-color: transparent; border-left: none;" class="input-group-text" id="basic-addon2"><i class="fas fa-paper-plane"></i></span>
                  </div>
                </div> -->
              </div>

            </div>

          </div>

        </div>
      </div>
      <pagination-controls *ngIf="reviewsDetail.reviews.length>5" style="text-align: center; margin-top: 2rem;"(pageChange)="pageChanged($event)"
    ></pagination-controls>
    </div>
    <div>



    </div>
  </div>
</div>
